---
title: "Gov 50 Final Project"
author: "Isabelle King"
description: "Final project"
output:
  distill::distill_article:
    self_contained: true
---

## Introduction

Does being white lead to an increase in income? In this study, I plan to evaluate the extent to which whiteness leads to higher income. I hypothesize that in Richmond, VA, being white positively impacts income.

Richmond, VA is my hometown. I grew up there and did not live anywhere else until coming to Harvard for college. Richmond was the capital of the Confederacy during the Civil War and since has had a dark history of racial discrimination and segregation; the last confederate monument in the city was only removed December of 2022. Furthermore, the construction of I-95 in the 1950s and the prolonged use of redlining have deeply impacted the city. In the summer of 2020, the New York Times profiled old redlining maps of Richmond, which first piqued my interest in the legacy of this practice (Plumer and Popovich 2020 "How Decades of Racist Housing Policy Left Neighborhoods Sweltering"). My impression is that Richmond remains deeply racially and socio-economically segregated today. I hope that this study will provide some evidence on this topic.   

## Data

The data used in this project is from the American Community Survey (ACS), which is the top source for demographic information on the US population, in the tidycensus package. The ACS is mailed to around 3.5 million households per year (approximately 3 percent of the US population). 

In this project, I will be using data from acs5 for the year 2020. The main independent variable is the proportion of the census tract that is white (prop_white) and the dependent variable is income (median_income). All variables are measured through the ACS survey. 

My research design is cross-sectional, meaning that I will compare the outcomes of the treated and control groups at one point in time. In order to do this, I have that these two groups are identical on average, like in an RCT (as-if randomized). My statistical controls, the proportion of the tract population that has a college or higher degree (prop_edu) and the proportion of the tract population that has private insurance (prop_private), will help adjust for confounders. 

Below is my code for tidying the data and plot of the dependent variable:

```{r}
library(tidyverse)
library(infer)
library(ggplot2)
```

```{r}
library(tidycensus)
```


```{r}
all_vars_acs5 <- 
  load_variables(year = 2020, dataset = "acs5")
```


```{r}
vars_acs5 <-
  c(
    median_income = "B06011_001",
    median_rent = "B25064_001", 
    white = "B02001_002", 
    black = "B02001_003", 
    total_pop = "B01003_001", 
    asian = "B02001_005", 
    pacific = "B02001_006", 
    american_indian = "B02001_004", 
    house_type = "B11001_001", 
    pov_by_age = "B17020_001", 
    house_income = "B19001_001", 
    house_earnings = "B19051_001", 
    house_wage = "B19052_001", 
    gini = "B19083_001", 
    per_income = "B19301_001", 
    rent = "B25062_001", 
    rent_income = "B25122_001", 
    college_edu = "B06009_005", 
    grad_edu = "B06009_006", 
    private_insur = "B27023_001"
    )
```


```{r}
rva_tracts <- get_acs(
  geography = "tract", 
  variable = vars_acs5, 
  state = "VA", 
  county = "Richmond City", 
  year = 2020
)
```


```{r}
wider_rva_tracts <- rva_tracts |>
  select(-moe) |>
  pivot_wider(names_from = variable, 
              values_from = estimate)
```


```{r}
plot_income <- wider_rva_tracts |>
  ggplot(mapping = aes(x = median_income, y = total_pop)) + 
  geom_col(position = "dodge", color = "steelblue1") + 
  labs(x = "Annual Income (in 2020 USD)", 
       y = "Number of Residents", 
       title = "Income in Richmond (2020)")
plot_income
```

## Results

I ran two regressions: a simple one with only the main independent variable and one multiple regression with the independent variables proportion of the census tract that is white (prop_white) and proportion of the census tract with a college degree (prop_college). Finally, I graphed a scatterplot of the proportion of white people and median income. 

In the simple regression, the estimated coefficient on prop_white is 39187. This means that for a one unit increase the proportion of white people in the tract (prop_white), income (median_income) is 391.87 percentage points higher. 

In the multiple regression, the estimated coefficient on prop_white is 8460. This means that for a one unit increase in the proportion of white people in the tract (prop_white), income (median_income) is 84.60 percentage points higher, after controlling for the possible confounder of the proportion of the population having a college degree (prop_college). The estimated coefficient on prop_college is 82343. This means that for a one unit increase in the proportion of having a college degree in the tract (prop_college), income (median_income) is 823.43 percentage points higher, after controlling for the possible confounder of the proportion of the population that is white (prop_white).  

In both regressions, increases in the proportion of white people in the tract means increases in the percentage points of income. Adding in the proportion of people in the tract with a college degree, however, severely decreases the associated percentage point increase. For example, in the simple regression, the percentage point increase in median_income is 391.87, while, in the multiple regression, the percentage point increase in median_income is 84.60. This difference implies that the proportion of white people in the tract is a crucial factor in median_income but the extent to which it is the most defining factor is unclear. As shown in the marked percentage point increase in multiple regression associated with the percentage of the census tract with a college degree (823.43), educational level could be more important. 

Statistically significant: we can reject the null of no effect 

```{r}
wider_rva_tracts <- wider_rva_tracts |>
  mutate(prop_white = white / total_pop, 
         prop_black = black / total_pop, 
         prop_private = private_insur / total_pop, 
         prop_college = college_edu / total_pop, 
         prop_grad = grad_edu / total_pop)
wider_rva_tracts <- wider_rva_tracts |>
  mutate(prop_edu = prop_college + prop_grad)
```

```{r}
reg <- lm(median_income ~ prop_white, 
           data = wider_rva_tracts)
reg
```

```{r}
modelsummary::modelsummary(reg,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))
```


```{r}
mult.reg <- lm(median_income ~ prop_white + prop_college,
               data = wider_rva_tracts)
mult.reg
```

```{r}
modelsummary::modelsummary(mult.reg,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))
```


```{r}
wider_rva_tracts |>
  ggplot(mapping = aes(x = prop_white, 
                       y = median_income)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) + 
  labs(x = "Proportion White", y = "Median Income", 
       title = "Scatterplot of the Proportion White 
       and Median Income")
```

## Conclusion

```{r}
max_table <- wider_rva_tracts |>
  group_by(NAME) |>
  summarize(mean_income = mean(median_income, 
                        na.rm = TRUE), 
            prop_white * 100, 
            prop_black *100, 
            prop_edu * 100) |>
  slice_max(mean_income, n = 10) |>
  knitr::kable(digits = 2, 
               col.names = c("Tract", "Average Income", 
                             "Percentage White", "Percentage Black", 
                             "Percentage Educated"))
max_table
```

```{r}
min_table <- wider_rva_tracts |>
  group_by(NAME) |>
  summarize(mean_income = mean(median_income, 
                        na.rm = TRUE), 
            prop_white * 100, 
            prop_black *100, 
            prop_edu * 100) |>
  slice_min(mean_income, n = 10) |>
  knitr::kable(digits = 2, 
               col.names = c("Tract", "Average Income", 
                             "Percentage White", "Percentage Black", 
                             "Percentage Educated"))
min_table
```

